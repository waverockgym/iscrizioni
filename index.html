<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Modulo Iscrizione</title>

<!-- Font titolo -->
<link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

<style>
  :root{
    --brand-primary: #00cf91;
    --brand-secondary: #0088ff;
    --bg: #f5f5f5;
  }

  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Roboto,Arial,sans-serif;background:var(--bg)}
  .outer{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}

  .card{
    width:100%;
    max-width:560px;
    background:#fff;
    border-radius:12px;
    padding:28px;             /* padding uguale sx/dx */
    box-shadow:0 8px 30px rgba(0,0,0,0.08);
  }

  h1{
    font-family:'Permanent Marker',cursive;
    color:var(--brand-primary);
    margin:0 0 18px 0;
    text-align:center;
    font-size:30px;
  }

  .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
  .full{grid-column:1/-1}

  label{display:block;font-weight:500;margin-bottom:6px;color:#333;font-size:14px}
  input[type="text"], input[type="tel"], input[type="date"]{
    width:100%;
    padding:12px 14px;
    border-radius:8px;
    border:1px solid #d0d0d0;
    font-size:15px;
  }
  input:focus{outline:none;border-color:var(--brand-primary);box-shadow:0 0 8px rgba(0,207,145,0.12)}

  .note{font-size:13px;color:#666;margin-top:6px}

  .actions{margin-top:18px;display:flex;gap:12px}
  button{
    flex:1;
    background:var(--brand-secondary);
    color:#fff;
    border:0;
    padding:12px 14px;
    border-radius:8px;
    font-size:16px;
    font-weight:600;
    cursor:pointer;
  }
  button:hover{filter:brightness(.95)}

  #message{margin-top:14px;text-align:center;font-weight:500}

  @media (max-width:560px){
    .grid{grid-template-columns:1fr}
    .card{padding:20px}
    h1{font-size:24px}
  }
</style>
</head>
<body>
  <div class="outer">
    <div class="card" role="form">
      <h1>Modulo Iscrizione</h1>

      <form id="registrationForm" autocomplete="off">
        <div class="grid">
          <div>
            <label for="cognome">Cognome</label>
            <input id="cognome" name="cognome" type="text" placeholder="Rossi" required>
          </div>

          <div>
            <label for="nome">Nome</label>
            <input id="nome" name="nome" type="text" placeholder="Mario" required>
          </div>

          <div>
            <label for="codiceFiscale">Codice fiscale</label>
            <input id="codiceFiscale" name="codiceFiscale" type="text"
       placeholder="RSSMRA80A01H501U" required
       style="text-transform: uppercase;"
       oninput="this.value = this.value.toUpperCase();">

          </div>

          <div>
            <label for="dataNascita">Data di nascita</label>
            <input id="dataNascita" name="dataNascita" type="date" required>
            <div class="note">Seleziona la data (icona calendario)</div>
          </div>

          <div>
            <label for="luogoNascita">Luogo di nascita</label>
            <input id="luogoNascita" name="luogoNascita" type="text" placeholder="Rimini" required>
          </div>

          <div>
            <label for="localita">Residente a</label>
            <input id="localita" name="localita" type="text" placeholder="Rimini centro" required>
          </div>

          <div class="full">
            <label for="via">in Via / Indirizzo</label>
            <input id="via" name="via" type="text" placeholder="Via Roma 1" required>
          </div>

          <div>
            <label for="cell">Cellulare</label>
            <input id="cell" name="cell" type="tel" placeholder="3331234567" required>
          </div>
          
          <div>
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="esempio@dominio.com" required>
          </div>


        </div>

        <div class="actions">
          <button type="submit">Invia</button>
        </div>

        <div id="message" aria-live="polite"></div>
      </form>
    </div>
  </div>

<script>
/*
  scriptUrl: assicurati sia quello del tuo deployment /exec
  Sostituisci se diverso.
*/
const scriptUrl = "https://script.google.com/macros/s/AKfycbyb-yE6IZA3nE1TGiKjiyHm26KOYF1f5074kMTe1w8iAQOjWj6kw-ee_y2FDYHH3lzaQA/exec";

function toDDMMYYYYFromInput(isoDate){ // isoDate = "yyyy-mm-dd"
  if(!isoDate) return "";
  const p = isoDate.split("-");
  if(p.length!==3) return "";
  return `${p[2]}/${p[1]}/${p[0]}`;
}

const form = document.getElementById("registrationForm");
const message = document.getElementById("message");
form.addEventListener("submit", async (ev) => {
  ev.preventDefault();
  message.textContent = ""; message.style.color = "";

  // read fields
  const nome = document.getElementById("nome").value.trim();
  const cognome = document.getElementById("cognome").value.trim();
  const codiceFiscale = document.getElementById("codiceFiscale").value.trim();
  const dataNascitaRaw = document.getElementById("dataNascita").value; // yyyy-mm-dd
  const luogoNascita = document.getElementById("luogoNascita").value.trim();
  const localita = document.getElementById("localita").value.trim();
  const via = document.getElementById("via").value.trim();
  const cell = document.getElementById("cell").value.trim();

  if(!cognome||!nome||!codiceFiscale||!dataNascitaRaw||!luogoNascita||!localita||!via||!cell){
    message.style.color = "red"; message.textContent = "Compila tutti i campi richiesti";
    return;
  }

  const dataNascita = toDDMMYYYYFromInput(dataNascitaRaw); // dd/mm/yyyy
  if(!dataNascita){
    message.style.color = "red"; message.textContent = "Data di nascita non valida";
    return;
  }

  // prepare payload as URLSearchParams (form-encoded)
  const payload = new URLSearchParams();
  payload.append("cognome", cognome);
  payload.append("nome", nome);
  payload.append("codiceFiscale", codiceFiscale);
  payload.append("dataNascita", dataNascita);
  payload.append("luogoNascita", luogoNascita);
  payload.append("localita", localita);
  payload.append("via", via);
  payload.append("cell", cell);

  try{
    const res = await fetch(scriptUrl, { method: "POST", body: payload });
    const text = await res.text();
    if(text === "Successo" || text === "OK"){
      message.style.color = "green"; message.textContent = "Iscrizione registrata correttamente";
      form.reset();
    } else {
      message.style.color = "red"; message.textContent = "Errore: " + text;
    }
  } catch(err){
    message.style.color = "red"; message.textContent = "Errore di rete: " + err.message;
  }
});
</script>
</body>
</html>



